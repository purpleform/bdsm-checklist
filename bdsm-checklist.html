<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>https://purpleform.github.io/bdsm-checklist/bdsm-checklist.html v1.7</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            color: white;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .legend-item {
            font-size: 14px;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .category {
            margin-bottom: 25px;
        }

        .category-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            font-size: 24px;
            font-weight: bold;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
        }

        .item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
            transition: background 0.2s;
            gap: 15px;
        }

        .item:hover {
            background: #f8f9ff;
        }

        .item-name {
            flex: 1;
            font-size: 15px;
            color: #333;
            min-width: 0;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .rating {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        .rating input[type="radio"] {
            display: none;
        }

        .rating label {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            border: 2px solid #ddd;
            transition: all 0.2s;
            background: white;
        }

        .rating label:hover {
            transform: scale(1.1);
        }

        .rating input[type="radio"]:checked + label {
            border-width: 3px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        /* 分数颜色 */
        .rating input[value="4"]:checked + label { background: #4ade80; border-color: #22c55e; color: white; }
        .rating input[value="3"]:checked + label { background: #86efac; border-color: #4ade80; color: white; }
        .rating input[value="2"]:checked + label { background: #bfdbfe; border-color: #60a5fa; color: white; }
        .rating input[value="1"]:checked + label { background: #fde68a; border-color: #fbbf24; color: #333; }
        .rating input[value="0"]:checked + label { background: #fca5a5; border-color: #ef4444; color: white; }
        .rating input[value="-1"]:checked + label { background: #f87171; border-color: #dc2626; color: white; }
        .rating input[value="-2"]:checked + label { background: #dc2626; border-color: #b91c1c; color: white; }
        .rating input[value="-3"]:checked + label { background: #991b1b; border-color: #7f1d1d; color: white; }

        .actions {
            margin-top: 30px;
            text-align: center;
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        button {
            padding: 15px 40px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .export-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .reset-btn {
            background: #e5e7eb;
            color: #374151;
        }

        .reset-btn:hover {
            background: #d1d5db;
        }

        @media (max-width: 1400px) {
            .container {
                padding: 20px;
            }

            .content {
                gap: 20px;
            }

            .item {
                flex-direction: column;
                align-items: flex-start;
                padding: 15px 10px;
            }

            .item-name {
                margin-bottom: 10px;
                font-size: 15px;
                width: 100%;
            }

            .rating {
                width: 100%;
                justify-content: space-between;
            }

            .rating label {
                width: 38px;
                height: 38px;
                font-size: 13px;
            }
        }

        @media (max-width: 900px) {
            .content {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .container {
                padding: 15px;
            }
        }

        @media (max-width: 768px) {
            .item-name {
                font-size: 16px;
            }

            .rating {
                gap: 5px;
            }

            .rating label {
                width: 36px;
                height: 36px;
            }

            .header h1 {
                font-size: 24px;
            }

            .legend {
                font-size: 12px;
                gap: 10px;
            }

            .category-title {
                font-size: 20px;
            }
        }

        @media (max-width: 480px) {
            .rating {
                gap: 3px;
            }

            .rating label {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }
        }

        @media (max-width: 380px) {
            .rating label {
                width: 28px;
                height: 28px;
                font-size: 11px;
            }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                max-width: 100%;
                box-shadow: none;
                padding: 20px;
            }

            .actions {
                display: none;
            }

            .content {
                grid-template-columns: 1fr;
            }

            .category {
                page-break-inside: avoid;
                break-inside: avoid;
                margin-bottom: 20px;
            }

            .item {
                page-break-inside: avoid;
                break-inside: avoid;
                flex-direction: row;
                padding: 8px 5px;
            }

            .item-name {
                font-size: 12px;
                margin-bottom: 0;
            }

            .rating {
                gap: 5px;
                flex-shrink: 0;
            }

            .rating label {
                width: 28px;
                height: 28px;
                font-size: 11px;
                border: 1px solid #999;
            }

            .header {
                margin-bottom: 20px;
            }

            .category-title {
                font-size: 18px;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>BDSM項目喜好紫評表 v1.7</h1>
            <div class="legend">
                <div class="legend-item">4 - 最喜歡</div>
                <div class="legend-item">3 - 喜歡</div>
                <div class="legend-item">2 - 接受</div>
                <div class="legend-item">1 - 可以試試</div>
                <div class="legend-item">0 - 沒試過</div>
                <div class="legend-item">-1 - 軟性界限</div>
                <div class="legend-item">-2 - 硬性界限</div>
                <div class="legend-item">-3 - 極限界限</div>
            </div>
        </div>

        <div class="content">
            <!-- 左側列 -->
            <div class="column-left">
                <!-- 性愛 -->
                <div class="category">
                    <div class="category-title">性愛</div>
                    <div class="items" id="sex"></div>
                </div>

                <!-- 寵物 -->
                <div class="category">
                    <div class="category-title">寵物</div>
                    <div class="items" id="pet"></div>
                </div>

                <!-- 拘束 -->
                <div class="category">
                    <div class="category-title">拘束</div>
                    <div class="items" id="bondage"></div>
                </div>

                <!-- 生物 -->
                <div class="category">
                    <div class="category-title">生物</div>
                    <div class="items" id="creature"></div>
                </div>

                <!-- 身體改造 -->
                <div class="category">
                    <div class="category-title">身體改造</div>
                    <div class="items" id="body-mod"></div>
                </div>
            </div>

            <!-- 右側列 -->
            <div class="column-right">
                <!-- 性玩具 -->
                <div class="category">
                    <div class="category-title">性玩具</div>
                    <div class="items" id="toys"></div>
                </div>

                <!-- 羞辱 -->
                <div class="category">
                    <div class="category-title">羞辱</div>
                    <div class="items" id="humiliation"></div>
                </div>

                <!-- 刑訊 -->
                <div class="category">
                    <div class="category-title">刑訊</div>
                    <div class="items" id="torture"></div>
                </div>

                <!-- 體液 -->
                <div class="category">
                    <div class="category-title">體液</div>
                    <div class="items" id="fluids"></div>
                </div>

                <!-- 其他 -->
                <div class="category">
                    <div class="category-title">其他</div>
                    <div class="items" id="others"></div>
                </div>
            </div>
        </div>

        <div class="actions">
            <button class="export-btn" onclick="exportPDF()">匯出PDF</button>
            <button class="export-btn" onclick="exportScreenshot()">匯出截圖</button>
            <button class="reset-btn" onclick="resetAll()">重置所有</button>
        </div>
    </div>

    <script>
        const items = {
            sex: [
                '用手幫主人自慰', '口爆', '口交', '吞精', '顏射', '肛交',
                '陰道內射', '肛門內射', '潮吹失禁', '情趣用品折磨',
                '強制連續高潮', '公共場所做愛', '主人面前侍奉其他人',
                '主人不在時侍奉其他人', '強姦', '輪姦', '多處被插入',
                '同性多人性行為', '異性多人性行為', '4P以上', '多奴/多主侍奉',
                '第四愛', '亂倫'
            ],
            pet: [
                '摸頭', '戀物', '尾巴穿戴', '爬行', '項圈', '餵食',
                '叼食物', '聞氣味', '學叫聲', '踩踏', '戶外暴露',
                '戶外調教', '戶外裸體', '戶外流放', '騎乘', '囚籠關押',
                '圈養'
            ],
            bondage: [
                '剝奪聽覺', '剝奪視覺', '禁言', '禁慾', '高潮後強制刺激',
                '繩藝', '拘束衣', '色情性拒絕（TD）', '貞操帶', '思維控制',
                '憋尿', '空吊/倒掛', '強制排泄', '監禁（多日）'
            ],
            creature: [
                '觸手/外星人（Cosplay）', '生物塞入', '獸交', '群獸輪交',
                '人獸同交', '昆蟲爬身'
            ],
            'body-mod': [
                '陰道擴張', '尿道擴張', '肛門擴張', '刺青', '催乳', '尿道刺激',
                '穿刺', '穿環', '疤痕', '烙印', '拳交', '藥物（激素）'
            ],
            toys: [
                '角色扮演', '制服誘惑', '挑選/訓練奴隸', '模特/人偶裝扮',
                '作為女僕（伺候）', '作為家居', '放置', '租賃/交易'
            ],
            humiliation: [
                '遠端指令', '不穿內衣', '羞恥視頻照片拍攝', '窺陰癖',
                '剃毛', '舔足', '視覺性騷擾', '言語管教',
                '言語羞辱（自身）', '淫妻/淫夫癖', '自慰展示', '女體盛',
                '內視鏡研究', '分享羞恥視頻照片', '出軌綠帽', '異性裝',
                '網絡公調', '露出（朋友）', '露出（生人）', '公共場所暴露',
                '公共場所調教', '公開場合項圈', '公開場合捆綁（衣內）',
                '公開場合器具（衣內）', '言語羞辱（親人）'
            ],
            torture: [
                '搔癢', '輕咬', '打屁股', '身上寫字', '滴蠟',
                '打耳光', '拉扯頭髮', '鞭子', '板拍', '鼻勾',
                '走繩', '冰刑', '坐臉', '舔肛', '虐乳',
                '體罰', '水刑', '火刑', '三角木馬', '灌腸',
                '虐陰/陽', '異物塗抹', '異物灌/塞入（陰道）', '異物灌/塞入（膀胱）',
                '異物灌/塞入（肛門）', '皮膚磨損', '踢踹', '性窒息',
                '電擊'
            ],
            fluids: [
                '唾液', '汗水', '飲尿', '飲經血', '尿浴', '糞浴',
                '食糞'
            ],
            others: [
                '多主/奴調教', 'ATM', '紫評表'
            ]
        };

        function createRatingButtons(categoryId, itemName, index) {
            const ratings = [4, 3, 2, 1, 0, -1, -2, -3];
            let html = '<div class="rating">';
            ratings.forEach(rating => {
                const id = `${categoryId}-${index}-${rating}`;
                html += `
                    <input type="radio" name="${categoryId}-${index}" value="${rating}" id="${id}">
                    <label for="${id}">${rating}</label>
                `;
            });
            html += '</div>';
            return html;
        }

        function initializeItems() {
            Object.keys(items).forEach(categoryId => {
                const container = document.getElementById(categoryId);
                if (container) {
                    items[categoryId].forEach((itemName, index) => {
                        const itemHtml = `
                            <div class="item">
                                <div class="item-name">${itemName}</div>
                                ${createRatingButtons(categoryId, itemName, index)}
                            </div>
                        `;
                        container.innerHTML += itemHtml;
                    });
                }
            });
        }

        function exportPDF() {
            const container = document.querySelector('.container');
            const actionsDiv = document.querySelector('.actions');

            // 暫時隱藏按鈕
            actionsDiv.style.display = 'none';

            html2canvas(container, {
                scale: 2,
                backgroundColor: '#ffffff',
                logging: false,
                useCORS: true,
                windowHeight: container.scrollHeight
            }).then(canvas => {
                // 恢復按鈕顯示
                actionsDiv.style.display = 'flex';

                const { jsPDF } = window.jspdf;
                const imgData = canvas.toDataURL('image/png');

                // 計算PDF尺寸 - 使用圖片的寬高比
                const imgWidth = canvas.width;
                const imgHeight = canvas.height;

                // 設定PDF尺寸以完整包含圖片
                // 使用mm為單位，A4寬度210mm
                const pdfWidth = 210;
                const pdfHeight = (imgHeight * pdfWidth) / imgWidth;

                // 創建自定義尺寸的PDF
                const pdf = new jsPDF({
                    orientation: pdfHeight > pdfWidth ? 'portrait' : 'landscape',
                    unit: 'mm',
                    format: [pdfWidth, pdfHeight]
                });

                // 將整張圖片放入PDF，不分頁
                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                pdf.save('BDSM項目喜好紫評表.pdf');
            }).catch(error => {
                actionsDiv.style.display = 'flex';
                console.error('PDF導出失敗:', error);
                alert('PDF導出失敗，請重試');
            });
        }

        function exportScreenshot() {
            const container = document.querySelector('.container');
            const actionsDiv = document.querySelector('.actions');

            // 暫時隱藏按鈕
            actionsDiv.style.display = 'none';

            html2canvas(container, {
                scale: 2,
                backgroundColor: '#ffffff',
                logging: false,
                useCORS: true
            }).then(canvas => {
                // 恢復按鈕顯示
                actionsDiv.style.display = 'flex';

                // 將canvas轉換為圖片並下載
                canvas.toBlob(blob => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = 'BDSM喜好紫評表.png';
                    link.click();
                    URL.revokeObjectURL(url);
                });
            }).catch(error => {
                actionsDiv.style.display = 'flex';
                console.error('截圖失敗:', error);
                alert('截圖失敗，請重試');
            });
        }

        function resetAll() {
            if (confirm('確定要重置所有評分嗎？')) {
                document.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.checked = false;
                });
            }
        }

        // 頁面載入時初始化
        window.addEventListener('DOMContentLoaded', initializeItems);
    </script>
</body>
</html>
