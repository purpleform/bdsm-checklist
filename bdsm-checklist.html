<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>https://purpleform.github.io/bdsm-checklist/bdsm-checklist.html v1.7</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            position: relative;
        }

        .watermark {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            user-select: none;
            z-index: 1;
            overflow: hidden;
        }

        .watermark-text {
            position: absolute;
            font-size: 48px;
            font-weight: bold;
            color: rgba(102, 126, 234, 0.1);
            white-space: nowrap;
            transform: rotate(-45deg);
            letter-spacing: 8px;
        }

        .content {
            position: relative;
            z-index: 2;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            color: white;
            position: relative;
            z-index: 2;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .legend-item {
            font-size: 14px;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .category {
            margin-bottom: 25px;
        }

        .category-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            font-size: 24px;
            font-weight: bold;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
        }

        .item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
            transition: background 0.2s;
            gap: 15px;
        }

        .item:hover {
            background: #f8f9ff;
        }

        .item-name {
            flex: 1;
            font-size: 15px;
            color: #333;
            min-width: 0;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .rating {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        .rating input[type="radio"] {
            display: none;
        }

        .rating label {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            border: 2px solid #ddd;
            transition: all 0.2s;
            background: white;
        }

        .rating label:hover {
            transform: scale(1.1);
        }

        .rating input[type="radio"]:checked + label {
            border-width: 3px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        /* 分数颜色 */
        .rating input[value="4"]:checked + label { background: #4ade80; border-color: #22c55e; color: white; }
        .rating input[value="3"]:checked + label { background: #86efac; border-color: #4ade80; color: white; }
        .rating input[value="2"]:checked + label { background: #bfdbfe; border-color: #60a5fa; color: white; }
        .rating input[value="1"]:checked + label { background: #fde68a; border-color: #fbbf24; color: #333; }
        .rating input[value="0"]:checked + label { background: #fca5a5; border-color: #ef4444; color: white; }
        .rating input[value="-1"]:checked + label { background: #f87171; border-color: #dc2626; color: white; }
        .rating input[value="-2"]:checked + label { background: #dc2626; border-color: #b91c1c; color: white; }
        .rating input[value="-3"]:checked + label { background: #991b1b; border-color: #7f1d1d; color: white; }

        .actions {
            margin-top: 30px;
            text-align: center;
            display: flex;
            gap: 15px;
            justify-content: center;
            position: relative;
            z-index: 2;
        }

        button {
            padding: 15px 40px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .export-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .reset-btn {
            background: #e5e7eb;
            color: #374151;
        }

        .reset-btn:hover {
            background: #d1d5db;
        }

        .footer {
            margin-top: 40px;
            padding: 25px;
            background: #f9fafb;
            border-radius: 10px;
            text-align: center;
            color: #6b7280;
            line-height: 1.8;
            font-size: 14px;
            border: 1px solid #e5e7eb;
            position: relative;
            z-index: 2;
        }

        .footer p {
            margin: 8px 0;
        }

        .footer a {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
        }

        .footer a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .lang-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 20px;
            padding: 8px 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            color: #667eea;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .lang-toggle:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        @media (max-width: 1400px) {
            .container {
                padding: 20px;
            }

            .content {
                gap: 20px;
            }

            .item {
                flex-direction: column;
                align-items: flex-start;
                padding: 15px 10px;
            }

            .item-name {
                margin-bottom: 10px;
                font-size: 15px;
                width: 100%;
            }

            .rating {
                width: 100%;
                justify-content: space-between;
            }

            .rating label {
                width: 38px;
                height: 38px;
                font-size: 13px;
            }
        }

        @media (max-width: 900px) {
            .content {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .container {
                padding: 15px;
            }
        }

        @media (max-width: 768px) {
            .item-name {
                font-size: 16px;
            }

            .rating {
                gap: 5px;
            }

            .rating label {
                width: 36px;
                height: 36px;
            }

            .header h1 {
                font-size: 24px;
            }

            .legend {
                font-size: 12px;
                gap: 10px;
            }

            .category-title {
                font-size: 20px;
            }

            .watermark-text {
                font-size: 40px;
                letter-spacing: 10px;
            }
        }

        @media (max-width: 480px) {
            .rating {
                gap: 3px;
            }

            .rating label {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }

            .watermark-text {
                font-size: 30px;
                letter-spacing: 5px;
            }
        }

        @media (max-width: 380px) {
            .rating label {
                width: 28px;
                height: 28px;
                font-size: 11px;
            }

            .watermark-text {
                font-size: 25px;
                letter-spacing: 3px;
            }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                max-width: 100%;
                box-shadow: none;
                padding: 20px;
            }

            .actions {
                display: none;
            }

            .lang-toggle {
                display: none;
            }

            .watermark {
                display: block !important;
            }

            .watermark-text {
                font-size: 50px;
                letter-spacing: 12px;
                color: rgba(102, 126, 234, 0.08);
            }

            .footer {
                display: block !important;
                margin-top: 20px;
                page-break-inside: avoid;
            }

            .content {
                grid-template-columns: 1fr;
            }

            .category {
                page-break-inside: avoid;
                break-inside: avoid;
                margin-bottom: 20px;
            }

            .item {
                page-break-inside: avoid;
                break-inside: avoid;
                flex-direction: row;
                padding: 8px 5px;
            }

            .item-name {
                font-size: 12px;
                margin-bottom: 0;
            }

            .rating {
                gap: 5px;
                flex-shrink: 0;
            }

            .rating label {
                width: 28px;
                height: 28px;
                font-size: 11px;
                border: 1px solid #999;
            }

            .header {
                margin-bottom: 20px;
            }

            .category-title {
                font-size: 18px;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <button class="lang-toggle" onclick="toggleLanguage()">简体中文</button>
    <div class="container">
        <div class="watermark" id="watermark-container"></div>
        <div class="header">
            <h1 data-zh-tw="BDSM項目喜好紫評表 v1.7" data-zh-cn="BDSM项目喜好紫评表 v1.7">BDSM項目喜好紫評表 v1.7</h1>
            <div class="legend">
                <div class="legend-item" data-zh-tw="4 - 最喜歡" data-zh-cn="4 - 最喜欢">4 - 最喜歡</div>
                <div class="legend-item" data-zh-tw="3 - 喜歡" data-zh-cn="3 - 喜欢">3 - 喜歡</div>
                <div class="legend-item" data-zh-tw="2 - 接受" data-zh-cn="2 - 接受">2 - 接受</div>
                <div class="legend-item" data-zh-tw="1 - 可以試試" data-zh-cn="1 - 可以试试">1 - 可以試試</div>
                <div class="legend-item" data-zh-tw="0 - 沒試過" data-zh-cn="0 - 没试过">0 - 沒試過</div>
                <div class="legend-item" data-zh-tw="-1 - 軟性界限" data-zh-cn="-1 - 软性界限">-1 - 軟性界限</div>
                <div class="legend-item" data-zh-tw="-2 - 硬性界限" data-zh-cn="-2 - 硬性界限">-2 - 硬性界限</div>
                <div class="legend-item" data-zh-tw="-3 - 極限界限" data-zh-cn="-3 - 极限界限">-3 - 極限界限</div>
            </div>
        </div>

        <div class="content">
            <!-- 左側列 -->
            <div class="column-left">
                <!-- 性愛 -->
                <div class="category">
                    <div class="category-title">性愛</div>
                    <div class="items" id="sex"></div>
                </div>

                <!-- 寵物 -->
                <div class="category">
                    <div class="category-title">寵物</div>
                    <div class="items" id="pet"></div>
                </div>

                <!-- 拘束 -->
                <div class="category">
                    <div class="category-title">拘束</div>
                    <div class="items" id="bondage"></div>
                </div>

                <!-- 生物 -->
                <div class="category">
                    <div class="category-title">生物</div>
                    <div class="items" id="creature"></div>
                </div>

                <!-- 身體改造 -->
                <div class="category">
                    <div class="category-title">身體改造</div>
                    <div class="items" id="body-mod"></div>
                </div>
            </div>

            <!-- 右側列 -->
            <div class="column-right">
                <!-- 性玩具 -->
                <div class="category">
                    <div class="category-title">性玩具</div>
                    <div class="items" id="toys"></div>
                </div>

                <!-- 羞辱 -->
                <div class="category">
                    <div class="category-title">羞辱</div>
                    <div class="items" id="humiliation"></div>
                </div>

                <!-- 刑訊 -->
                <div class="category">
                    <div class="category-title">刑訊</div>
                    <div class="items" id="torture"></div>
                </div>

                <!-- 體液 -->
                <div class="category">
                    <div class="category-title">體液</div>
                    <div class="items" id="fluids"></div>
                </div>

                <!-- 其他 -->
                <div class="category">
                    <div class="category-title">其他</div>
                    <div class="items" id="others"></div>
                </div>
            </div>
        </div>

        <div class="actions">
            <button class="export-btn" onclick="exportPDF()" data-zh-tw="匯出PDF" data-zh-cn="导出PDF">匯出PDF</button>
            <button class="export-btn" onclick="exportScreenshot()" data-zh-tw="匯出截圖" data-zh-cn="导出截图">匯出截圖</button>
            <button class="reset-btn" onclick="resetAll()" data-zh-tw="重置所有" data-zh-cn="重置所有">重置所有</button>
        </div>

        <div class="footer">
            <p data-zh-tw="此表格由《簡稱樂園》BDSM群內成員合作協力製作而成的不完全項目總匯，刻意避開了一些涉及傷害自己或他人的性偏離項目。" data-zh-cn="此表格由《简称乐园》BDSM群内成员合作协力制作而成的不完全项目总汇，刻意避开了一些涉及伤害自己或他人的性偏离项目。">此表格由《簡稱樂園》BDSM群內成員合作協力製作而成的不完全項目總匯，刻意避開了一些涉及傷害自己或他人的性偏離項目。</p>
            <p data-zh-tw="請勿擦掉浮水印複製貼上修改後另行發布。如果你花錢購買了此物，恭喜你被騙了！" data-zh-cn="请勿擦掉水印复制粘贴修改后另行发布。如果你花钱购买了此物，恭喜你被骗了！">請勿擦掉浮水印複製貼上修改後另行發布。如果你花錢購買了此物，恭喜你被騙了！</p>
            <p data-zh-tw="如果被你從別處看到的，哎喲挺有緣的。" data-zh-cn="如果被你从别处看到的，哎哟挺有缘的。">如果被你從別處看到的，哎喲挺有緣的。</p>
            <p style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e5e7eb;">
                <strong data-zh-tw="貢獻者" data-zh-cn="贡献者">貢獻者</strong><br>
                <span data-zh-tw="BDSM項目搜集：CiCi ｜ 紫評表製作：長風 ｜ 網頁版製作：六六" data-zh-cn="BDSM项目搜集：CiCi ｜ 紫评表制作：长风 ｜ 网页版制作：六六">BDSM項目搜集：CiCi ｜ 紫評表製作：長風 ｜ 網頁版製作：六六</span>
            </p>
            <p><span data-zh-tw="我們的推特" data-zh-cn="我们的推特">我們的推特</span> <a href="https://twitter.com/CF_IS_HERE" target="_blank">@CF_IS_HERE</a></p>
        </div>
    </div>

    <script>
        let currentLang = 'zh-tw';

        // 生成重複浮水印
        function generateWatermarks() {
            const container = document.getElementById('watermark-container');
            container.innerHTML = '';

            const watermarkText = currentLang === 'zh-tw' ? '簡稱樂園 @CF_IS_HERE' : '简称乐园 @CF_IS_HERE';
            const spacingY = 150; // 垂直間距
            const spacingX = 500; // 水平間距

            // 計算需要多少行和列
            const containerHeight = document.querySelector('.container').scrollHeight;
            const containerWidth = document.querySelector('.container').scrollWidth;

            // 因為旋轉45度，需要更多的覆蓋範圍
            const rows = Math.ceil(containerHeight / spacingY) + 6;
            const cols = Math.ceil(containerWidth / spacingX) + 6;

            for (let row = -3; row < rows; row++) {
                for (let col = -3; col < cols; col++) {
                    const span = document.createElement('span');
                    span.className = 'watermark-text';
                    span.textContent = watermarkText;

                    // 交錯排列：奇數行向右偏移半個間距
                    const offsetX = (row % 2 === 0) ? 0 : spacingX / 2;

                    span.style.top = (row * spacingY) + 'px';
                    span.style.left = (col * spacingX + offsetX) + 'px';
                    container.appendChild(span);
                }
            }
        }

        const items = {
            'zh-tw': {
                sex: [
                '用手幫主人自慰', '口爆', '口交', '吞精', '顏射', '肛交',
                '陰道內射', '肛門內射', '潮吹失禁', '情趣用品折磨',
                '強制連續高潮', '公共場所做愛', '主人面前侍奉其他人',
                '主人不在時侍奉其他人', '強姦', '輪姦', '多處被插入',
                '同性多人性行為', '異性多人性行為', '4P以上', '多奴/多主侍奉',
                '第四愛', '亂倫'
            ],
            pet: [
                '摸頭', '戀物', '尾巴穿戴', '爬行', '項圈', '餵食',
                '叼食物', '聞氣味', '學叫聲', '踩踏', '戶外暴露',
                '戶外調教', '戶外裸體', '戶外流放', '騎乘', '囚籠關押',
                '圈養'
            ],
            bondage: [
                '剝奪聽覺', '剝奪視覺', '禁言', '禁慾', '高潮後強制刺激',
                '繩藝', '拘束衣', '色情性拒絕（TD）', '貞操帶', '思維控制',
                '憋尿', '空吊/倒掛', '強制排泄', '監禁（多日）'
            ],
            creature: [
                '觸手/外星人（Cosplay）', '生物塞入', '獸交', '群獸輪交',
                '人獸同交', '昆蟲爬身'
            ],
            'body-mod': [
                '陰道擴張', '尿道擴張', '肛門擴張', '刺青', '催乳', '尿道刺激',
                '穿刺', '穿環', '疤痕', '烙印', '拳交', '藥物（激素）'
            ],
            toys: [
                '角色扮演', '制服誘惑', '挑選/訓練奴隸', '模特/人偶裝扮',
                '作為女僕（伺候）', '作為家居', '放置', '租賃/交易'
            ],
            humiliation: [
                '遠端指令', '不穿內衣', '羞恥視頻照片拍攝', '窺陰癖',
                '剃毛', '舔足', '視覺性騷擾', '言語管教',
                '言語羞辱（自身）', '淫妻/淫夫癖', '自慰展示', '女體盛',
                '內視鏡研究', '分享羞恥視頻照片', '出軌綠帽', '異性裝',
                '網絡公調', '露出（朋友）', '露出（生人）', '公共場所暴露',
                '公共場所調教', '公開場合項圈', '公開場合捆綁（衣內）',
                '公開場合器具（衣內）', '言語羞辱（親人）'
            ],
            torture: [
                '搔癢', '輕咬', '打屁股', '身上寫字', '滴蠟',
                '打耳光', '拉扯頭髮', '鞭子', '板拍', '鼻勾',
                '走繩', '冰刑', '坐臉', '舔肛', '虐乳',
                '體罰', '水刑', '火刑', '三角木馬', '灌腸',
                '虐陰/陽', '異物塗抹', '異物灌/塞入（陰道）', '異物灌/塞入（膀胱）',
                '異物灌/塞入（肛門）', '皮膚磨損', '踢踹', '性窒息',
                '電擊'
            ],
            fluids: [
                '唾液', '汗水', '飲尿', '飲經血', '尿浴', '糞浴',
                '食糞'
            ],
            others: [
                '多主/奴調教', 'ATM', '紫評表'
            ]
                },
            'zh-cn': {
                sex: [
                '用手帮主人自慰', '口爆', '口交', '吞精', '颜射', '肛交',
                '阴道内射', '肛门内射', '潮吹失禁', '情趣用品折磨',
                '强制连续高潮', '公共场所做爱', '主人面前侍奉其他人',
                '主人不在时侍奉其他人', '强奸', '轮奸', '多处被插入',
                '同性多人性行为', '异性多人性行为', '4P以上', '多奴/多主侍奉',
                '第四爱', '乱伦'
            ],
            pet: [
                '摸头', '恋物', '尾巴穿戴', '爬行', '项圈', '喂食',
                '叼食物', '闻气味', '学叫声', '踩踏', '户外暴露',
                '户外调教', '户外裸体', '户外流放', '骑乘', '囚笼关押',
                '圈养'
            ],
            bondage: [
                '剥夺听觉', '剥夺视觉', '禁言', '禁欲', '高潮后强制刺激',
                '绳艺', '拘束衣', '色情性拒绝（TD）', '贞操带', '思维控制',
                '憋尿', '空吊/倒挂', '强制排泄', '监禁（多日）'
            ],
            creature: [
                '触手/外星人（Cosplay）', '生物塞入', '兽交', '群兽轮交',
                '人兽同交', '昆虫爬身'
            ],
            'body-mod': [
                '阴道扩张', '尿道扩张', '肛门扩张', '刺青', '催乳', '尿道刺激',
                '穿刺', '穿环', '疤痕', '烙印', '拳交', '药物（激素）'
            ],
            toys: [
                '角色扮演', '制服诱惑', '挑选/训练奴隶', '模特/人偶装扮',
                '作为女仆（伺候）', '作为家居', '放置', '租赁/交易'
            ],
            humiliation: [
                '远端指令', '不穿内衣', '羞耻视频照片拍摄', '窥阴癖',
                '剃毛', '舔足', '视觉性骚扰', '言语管教',
                '言语羞辱（自身）', '淫妻/淫夫癖', '自慰展示', '女体盛',
                '内视镜研究', '分享羞耻视频照片', '出轨绿帽', '异性装',
                '网络公调', '露出（朋友）', '露出（生人）', '公共场所暴露',
                '公共场所调教', '公开场合项圈', '公开场合捆绑（衣内）',
                '公开场合器具（衣内）', '言语羞辱（亲人）'
            ],
            torture: [
                '搔痒', '轻咬', '打屁股', '身上写字', '滴蜡',
                '打耳光', '拉扯头发', '鞭子', '板拍', '鼻钩',
                '走绳', '冰刑', '坐脸', '舔肛', '虐乳',
                '体罚', '水刑', '火刑', '三角木马', '灌肠',
                '虐阴/阳', '异物涂抹', '异物灌/塞入（阴道）', '异物灌/塞入（膀胱）',
                '异物灌/塞入（肛门）', '皮肤磨损', '踢踹', '性窒息',
                '电击'
            ],
            fluids: [
                '唾液', '汗水', '饮尿', '饮经血', '尿浴', '粪浴',
                '食粪'
            ],
            others: [
                '多主/奴调教', 'ATM', '紫评表'
            ]
            }
        };

        const categoryNames = {
            'zh-tw': {
                sex: '性愛',
                pet: '寵物',
                bondage: '拘束',
                creature: '生物',
                'body-mod': '身體改造',
                toys: '性玩具',
                humiliation: '羞辱',
                torture: '刑訊',
                fluids: '體液',
                others: '其他'
            },
            'zh-cn': {
                sex: '性爱',
                pet: '宠物',
                bondage: '拘束',
                creature: '生物',
                'body-mod': '身体改造',
                toys: '性玩具',
                humiliation: '羞辱',
                torture: '刑讯',
                fluids: '体液',
                others: '其他'
            }
        };

        function createRatingButtons(categoryId, itemName, index) {
            const ratings = [4, 3, 2, 1, 0, -1, -2, -3];
            let html = '<div class="rating">';
            ratings.forEach(rating => {
                const id = `${categoryId}-${index}-${rating}`;
                html += `
                    <input type="radio" name="${categoryId}-${index}" value="${rating}" id="${id}">
                    <label for="${id}">${rating}</label>
                `;
            });
            html += '</div>';
            return html;
        }

        function initializeItems() {
            const currentItems = items[currentLang];
            Object.keys(currentItems).forEach(categoryId => {
                const container = document.getElementById(categoryId);
                if (container) {
                    container.innerHTML = ''; // 清空現有內容
                    currentItems[categoryId].forEach((itemName, index) => {
                        const itemHtml = `
                            <div class="item">
                                <div class="item-name">${itemName}</div>
                                ${createRatingButtons(categoryId, itemName, index)}
                            </div>
                        `;
                        container.innerHTML += itemHtml;
                    });
                }
            });

            // 更新分類標題
            Object.keys(categoryNames[currentLang]).forEach(categoryId => {
                const titleElement = document.querySelector(`#${categoryId}`).previousElementSibling;
                if (titleElement && titleElement.classList.contains('category-title')) {
                    titleElement.textContent = categoryNames[currentLang][categoryId];
                }
            });
        }

        function toggleLanguage() {
            const langButton = document.querySelector('.lang-toggle');

            if (currentLang === 'zh-tw') {
                currentLang = 'zh-cn';
                langButton.textContent = '繁體中文';
            } else {
                currentLang = 'zh-tw';
                langButton.textContent = '简体中文';
            }

            // 更新所有帶有語言屬性的元素
            document.querySelectorAll('[data-zh-tw]').forEach(element => {
                element.textContent = element.getAttribute(`data-${currentLang}`);
            });

            // 重新載入項目
            initializeItems();

            // 重新生成浮水印
            generateWatermarks();
        }

        function exportPDF() {
            const container = document.querySelector('.container');
            const actionsDiv = document.querySelector('.actions');
            const langToggle = document.querySelector('.lang-toggle');

            // 暫時隱藏按鈕
            actionsDiv.style.display = 'none';
            langToggle.style.display = 'none';

            html2canvas(container, {
                scale: 2,
                backgroundColor: '#ffffff',
                logging: false,
                useCORS: true,
                windowHeight: container.scrollHeight
            }).then(canvas => {
                // 恢復按鈕顯示
                actionsDiv.style.display = 'flex';
                langToggle.style.display = 'block';

                const { jsPDF } = window.jspdf;
                const imgData = canvas.toDataURL('image/png');

                // 計算PDF尺寸 - 使用圖片的寬高比
                const imgWidth = canvas.width;
                const imgHeight = canvas.height;

                // 設定PDF尺寸以完整包含圖片
                // 使用mm為單位，A4寬度210mm
                const pdfWidth = 210;
                const pdfHeight = (imgHeight * pdfWidth) / imgWidth;

                // 創建自定義尺寸的PDF
                const pdf = new jsPDF({
                    orientation: pdfHeight > pdfWidth ? 'portrait' : 'landscape',
                    unit: 'mm',
                    format: [pdfWidth, pdfHeight]
                });

                // 將整張圖片放入PDF，不分頁
                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                const filename = currentLang === 'zh-tw' ? 'BDSM項目喜好紫評表.pdf' : 'BDSM项目喜好紫评表.pdf';
                pdf.save(filename);
            }).catch(error => {
                actionsDiv.style.display = 'flex';
                langToggle.style.display = 'block';
                console.error('PDF導出失敗:', error);
                const errorMsg = currentLang === 'zh-tw' ? 'PDF導出失敗，請重試' : 'PDF导出失败，请重试';
                alert(errorMsg);
            });
        }

        function exportScreenshot() {
            const container = document.querySelector('.container');
            const actionsDiv = document.querySelector('.actions');
            const langToggle = document.querySelector('.lang-toggle');

            // 暫時隱藏按鈕
            actionsDiv.style.display = 'none';
            langToggle.style.display = 'none';

            html2canvas(container, {
                scale: 2,
                backgroundColor: '#ffffff',
                logging: false,
                useCORS: true
            }).then(canvas => {
                // 恢復按鈕顯示
                actionsDiv.style.display = 'flex';
                langToggle.style.display = 'block';

                // 將canvas轉換為圖片並下載
                canvas.toBlob(blob => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    const filename = currentLang === 'zh-tw' ? 'BDSM喜好紫評表.png' : 'BDSM喜好紫评表.png';
                    link.download = filename;
                    link.click();
                    URL.revokeObjectURL(url);
                });
            }).catch(error => {
                actionsDiv.style.display = 'flex';
                langToggle.style.display = 'block';
                console.error('截圖失敗:', error);
                const errorMsg = currentLang === 'zh-tw' ? '截圖失敗，請重試' : '截图失败，请重试';
                alert(errorMsg);
            });
        }

        function resetAll() {
            const confirmMsg = currentLang === 'zh-tw' ? '確定要重置所有評分嗎？' : '确定要重置所有评分吗？';
            if (confirm(confirmMsg)) {
                document.querySelectorAll('input[type="radio"]').forEach(radio => {
                    radio.checked = false;
                });
            }
        }

        // 頁面載入時初始化
        window.addEventListener('DOMContentLoaded', function() {
            initializeItems();
            generateWatermarks();
        });

        // 窗口大小改變時重新生成浮水印
        window.addEventListener('resize', generateWatermarks);
    </script>
</body>
</html>
